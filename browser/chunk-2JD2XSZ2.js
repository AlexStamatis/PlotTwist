import{L as a,db as r,eb as l,kb as m,pb as i,w as c,z as n}from"./chunk-P4JO3VSF.js";var g=class s{constructor(e,t){this.http=e;this.router=t}apikey=i.tmdbApiKey;baseUrl=i.tmdbBaseUrl;isLoggedIn=a(!!localStorage.getItem("session_id"));username=a(localStorage.getItem("username"));requestToken(){let e=`${this.baseUrl}/authentication/token/new`,t=new r().set("api_key",this.apikey);return this.http.get(e,{params:t})}redirectToTmdbAuth(e){let t=window.location.origin,o=i.production?"/PlotTwist":"",u=`${t}${o}/auth/done`,p=`https://www.themoviedb.org/authenticate/${e}?redirect_to=${encodeURIComponent(u)}`;window.location.href=p}createSession(e){let t=`${this.baseUrl}/authentication/session/new`,o=new r().set("api_key",this.apikey);return this.http.post(t,{request_token:e},{params:o})}getAccountDetails(e){let t=`${this.baseUrl}/account`,o=new r().set("api_key",this.apikey).set("session_id",e);return this.http.get(t,{params:o})}login(e,t,o){localStorage.setItem("session_id",e),localStorage.setItem("username",t),localStorage.setItem("user_id",o),this.isLoggedIn.set(!0),this.username.set(t)}logout(){localStorage.removeItem("session_id"),localStorage.removeItem("username"),localStorage.removeItem("user_id"),this.isLoggedIn.set(!1),this.username.set(null),this.router.navigate(["/"])}getSessionId(){return localStorage.getItem("session_id")||""}getAccountId(){return localStorage.getItem("user_id")}static \u0275fac=function(t){return new(t||s)(n(l),n(m))};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{g as a};
