import{n as ee}from"./chunk-4A7SGHI4.js";import{a as ie}from"./chunk-UNCITDDM.js";import{a as te}from"./chunk-BJMUVMDY.js";import{$ as u,$a as S,Ca as l,Da as v,Ea as d,Fa as V,Ga as B,H as b,Ha as U,I as C,Ia as L,La as G,Na as J,O as g,Oa as D,Q as y,Qa as R,S as a,U as w,Va as F,W as I,Wa as $,Za as q,_a as H,a as k,b as W,bb as K,ca as p,cb as Q,eb as P,ga as z,ia as j,ja as N,ka as s,la as r,ma as M,nb as X,pb as Y,qa as A,qb as Z,sa as x,ta as m,ub as O}from"./chunk-2CIC56OY.js";function le(n,i){if(n&1&&(s(0,"p",5),l(1),r()),n&2){let e=m();a(),V(" ",e.castMember.total_episode_count," episode ",e.castMember.total_episode_count>1?"s":""," ")}}var T=class n{constructor(i){this.router=i}castMember;showEpisodeCount=!1;goToCastDetails(i){this.router.navigate(["/person",i])}static \u0275fac=function(e){return new(e||n)(w(Y))};static \u0275cmp=I({type:n,selectors:[["app-cast-card"]],inputs:{castMember:"castMember",showEpisodeCount:"showEpisodeCount"},decls:8,vars:5,consts:[[1,"card-wrapper"],[1,"profile",3,"click","src","alt"],[1,"person-details"],[1,"character"],["class","episodes",4,"ngIf"],[1,"episodes"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"img",1),x("click",function(){return t.goToCastDetails(t.castMember.id)}),r(),s(2,"div",2)(3,"h3"),l(4),r(),s(5,"p",3),l(6),r(),u(7,le,2,2,"p",4),r()()),e&2&&(a(),p("src","https://image.tmdb.org/t/p/w185"+t.castMember.profile_path,y)("alt",t.castMember.name),a(3),v(t.castMember.name),a(2),v(t.castMember.character),a(),p("ngIf",t.showEpisodeCount&&t.castMember.total_episode_count))},dependencies:[P,S,O],styles:[".card-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:clamp(120px,20vw,160px);align-items:center;cursor:pointer;color:#fff;text-align:center;margin:clamp(10px,2vw,20px)}.profile[_ngcontent-%COMP%]{width:100%;height:clamp(160px,20vw,220px);object-fit:cover;border-radius:8px}.person-details[_ngcontent-%COMP%]{margin-top:clamp(8px,1vw,16px)}.person-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:clamp(1rem,1.5vw,1.3rem);font-weight:700}.character[_ngcontent-%COMP%], .episodes[_ngcontent-%COMP%]{font-size:clamp(.8rem,1vw,1rem);color:#cacaca;line-height:1.4}"]})};var pe=(n,i,e)=>({"bi-star-fill":n,"bi-star-half":i,"bi-star":e}),me=n=>["/person",n],de=(n,i)=>i.id;function ge(n,i){if(n&1&&(s(0,"span",22),l(1),r()),n&2){let e=m().ngIf;a(),d(" ",e.runtime," min ")}}function fe(n,i){if(n&1&&M(0,"i",23),n&2){let e=i.fill;p("ngClass",J(1,pe,e===100,e>0&&e<100,e===0))}}function ue(n,i){if(n&1&&(s(0,"div",26)(1,"a",27),l(2),r(),s(3,"span",28),l(4),r()()),n&2){let e=i.$implicit;a(),p("routerLink",G(3,me,e.id)),a(),d(" ",e.name," "),a(2),d(" ",e.roles.join(", "),"")}}function ve(n,i){if(n&1&&(s(0,"div",24),u(1,ue,5,5,"div",25),r()),n&2){let e=m(2);a(),p("ngForOf",e.groupCrewByPerson())}}function _e(n,i){if(n&1){let e=A();s(0,"div",2)(1,"div",3),M(2,"img",4),r(),s(3,"div",5)(4,"h2",6),l(5),s(6,"span",7),l(7),r()(),s(8,"div",8)(9,"span",9),l(10),D(11,"date"),r(),s(12,"span",10)(13,"span",11),l(14,"\u2022"),r(),l(15),r(),s(16,"span",11),l(17,"\u2022"),r(),u(18,ge,2,1,"span",12),r(),s(19,"div",13),l(20),D(21,"number"),r(),s(22,"p",14),l(23),r(),s(24,"div",15)(25,"button",16),x("click",function(){b(e);let o=m();return C(o.toggleFavorite())}),s(26,"span",17),l(27),r(),l(28),r(),s(29,"button",16),x("click",function(){b(e);let o=m();return C(o.toggleWatchlist())}),s(30,"span",17),l(31),r(),l(32),r()(),s(33,"div",18)(34,"ngb-rating",19),L("rateChange",function(o){b(e);let c=m();return U(c.starRating,o)||(c.starRating=o),C(o)}),x("rateChange",function(o){b(e);let c=m();return C(c.movieRate(o))}),u(35,fe,1,5,"ng-template"),r(),s(36,"span",20),l(37),r()(),u(38,ve,2,1,"div",21),r()()}if(n&2){let e=i.ngIf,t=m();a(2),p("src","https://image.tmdb.org/t/p/w500"+e.poster_path,y),a(3),d(" ",e.title||e.name," "),a(2),d("(",(e.release_date||e.first_air_date)==null?null:(e.release_date||e.first_air_date).slice(0,4),")"),a(3),d(" ",R(11,17,e.release_date||e.first_air_date,"MM/dd/yyyy")," (GR) "),a(5),d(" ",t.genres()," "),a(3),p("ngIf",e.runtime),a(2),d(" ",e.vote_average>0?R(21,20,e.vote_average,"1.1-1"):"NR"," "),a(3),v(e.overview),a(4),v(t.isFavourite()?"\u2605":"\u2606"),a(),d(" ",t.isFavourite()?"In Favorites":"Add to Favorites"," "),a(3),v(t.isWatchlisted()?"\u2714":"+"),a(),d(" ",t.isWatchlisted()?"In Watchlist":"Add to Watchlist"," "),a(2),B("rate",t.starRating),p("max",10)("readonly",!1),a(3),d("(",t.userRating()||"Not Rated",")"),a(),p("ngIf",t.groupCrewByPerson().length)}}function xe(n,i){if(n&1&&M(0,"app-cast-card",32),n&2){let e=i.$implicit,t=m(2);p("castMember",e)("showEpisodeCount",t.mediaType()==="tv")}}function he(n,i){if(n&1&&(s(0,"div",29)(1,"h3",30),l(2,"Top Billed Cast"),r(),s(3,"div",31),j(4,xe,1,2,"app-cast-card",32,de),r()()),n&2){let e=m();a(4),N(e.cast().slice(0,20))}}function be(n,i){n&1&&M(0,"app-spinner")}var ne=class n{constructor(i,e){this.route=i;this.tmdbService=e;let t=this.route.snapshot.routeConfig?.path?.startsWith("tv")?"tv":"movie",o=this.route.snapshot.paramMap.get("id");this.mediaType.set(t),this.id.set(o?+o:null),$(()=>{let c=this.id(),f=this.mediaType();c&&f&&(this.loading.set(!0),this.tmdbService.getMovieDetails(f,c).subscribe(E=>{this.details.set(E);let h=[];if(f==="tv"&&E.created_by?.length){let _=E.created_by.map(oe=>W(k({},oe),{job:"Creator"}));h=[...h,..._]}this.tmdbService.getCredits(f,c).subscribe(_=>{_.crew?.length&&(h=[...h,..._.crew]),this.crew.set(h),_.cast?.length&&this.cast.set(_.cast),this.loading.set(!1)})}))})}mediaType=g("movie");id=g(null);details=g(null);crew=g([]);cast=g([]);isFavourite=g(!1);isWatchlisted=g(!1);userRating=g(null);starRating=g(0);loading=g(!0);ngOnInit(){this.loadUserActions()}setInitialRating(i){this.starRating.set(i)}loadUserActions(){let i=localStorage.getItem("user_id"),e=localStorage.getItem("session_id"),t=this.id();!i||!e||!t||(this.tmdbService.getFavorites(i,e,this.mediaType()).subscribe(o=>{let c=o.results.find(f=>f.id===t);this.isFavourite.set(!!c)}),this.tmdbService.getUserWatchlist(i,e,this.mediaType()).subscribe(o=>{let c=o.results.find(f=>f.id===t);this.isWatchlisted.set(!!c)}),this.tmdbService.getUserRatings(i,e,this.mediaType()).subscribe(o=>{let c=o.results.find(f=>f.id===t);console.log("Found rating:",c),c&&(this.starRating.set(c.rating),this.userRating.set(c.rating),this.setInitialRating(c.rating))}))}toggleFavorite(){let i=localStorage.getItem("user_id"),e=localStorage.getItem("session_id"),t=this.id(),o=this.mediaType();if(!i||!e||!t)return;let c=!this.isFavourite();this.tmdbService.markAsFavorite(i,e,{media_type:o,media_id:t,favorite:c}).subscribe(()=>{this.isFavourite.set(c)})}toggleWatchlist(){let i=localStorage.getItem("user_id"),e=localStorage.getItem("session_id"),t=this.id(),o=this.mediaType();if(console.log("Toggle Watchlist:",{accountId:i,sessionId:e,id:t,media:o}),!i||!e||!t)return;let c=!this.isWatchlisted();this.tmdbService.addToWatchlist(i,e,{media_type:o,media_id:t,watchlist:c}).subscribe(()=>{this.isWatchlisted.set(c)})}movieRate(i){let e=localStorage.getItem("session_id"),t=this.id(),o=this.mediaType();!e||!t||this.tmdbService.rateMovieorSeries(o,t,e,i).subscribe(()=>{this.userRating.set(i),this.starRating.set(i)})}genres=F(()=>this.details()?.genres?.map(e=>e.name).join(", ")||"");groupCrewByPerson=F(()=>{let i=new Map,e=["Director","Screenplay","Writer","Story","Creator","Writing","Directing"];for(let t of this.crew()){if(!e.includes(t.job))continue;let o=i.get(t.id);o?o.roles.includes(t.job)||o.roles.push(t.job):i.set(t.id,{id:t.id,name:t.name,roles:[t.job]})}return Array.from(i.values())});static \u0275fac=function(e){return new(e||n)(w(X),w(te))};static \u0275cmp=I({type:n,selectors:[["app-movie-details"]],decls:3,vars:3,consts:[["class","details-container",4,"ngIf"],["class","cast-container",4,"ngIf"],[1,"details-container"],[1,"poster-wrapper"],[3,"src"],[1,"info-wrapper"],[1,"title"],[1,"year"],[1,"more-info"],[1,"release-date"],[1,"genres"],[1,"bullet"],["class","runtime",4,"ngIf"],[1,"rating-badge"],[1,"overview"],[1,"actions-container"],[1,"action-button",3,"click"],[1,"icon"],[1,"rating-container","custom-ngb-rating"],[3,"rateChange","rate","max","readonly"],[1,"current-rating"],["class","crew-info",4,"ngIf"],[1,"runtime"],[1,"bi",3,"ngClass"],[1,"crew-info"],["class","crew-type",4,"ngFor","ngForOf"],[1,"crew-type"],[1,"person-link",3,"routerLink"],[1,"job"],[1,"cast-container"],[1,"section-title"],[1,"cast-grid"],[3,"castMember","showEpisodeCount"]],template:function(e,t){e&1&&u(0,_e,39,23,"div",0)(1,he,6,0,"div",1)(2,be,1,0,"app-spinner"),e&2&&(p("ngIf",t.details()),a(),p("ngIf",t.cast().length),a(),z(t.loading()?2:-1))},dependencies:[P,q,H,S,Q,K,O,Z,T,ee,ie],styles:[".details-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;color:#fff;gap:clamp(10px,2vw,30px);padding:clamp(10px,2vw,20px);background-color:#0d083aca}@media (max-width: 768px){.details-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:start}}.poster-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:clamp(200px,25vw,300px);border-radius:12px;object-fit:cover;margin-left:clamp(30px,5vw,100px)}.info-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:column}.title[_ngcontent-%COMP%]{font-size:clamp(1.8rem,2vw + 1rem,3rem);font-weight:700}.title[_ngcontent-%COMP%]   .year[_ngcontent-%COMP%]{font-weight:400;font-size:clamp(1.2rem,1vw + .5rem,2rem);color:#ccc;margin-left:5px}.more-info[_ngcontent-%COMP%]{display:flex;font-size:15px;gap:8px;color:#bbb;margin-bottom:15px;text-align:center}.bullet[_ngcontent-%COMP%]{font-size:15px;padding:0 5px;color:#c7c7c7}.rating-badge[_ngcontent-%COMP%]{background-color:#354245d9;color:#f1b903;border-radius:50%;width:clamp(40px,4vw,55px);height:clamp(40px,4vw,55px);font-size:clamp(1.2rem,1.8vw,1.5rem);font-weight:700;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 6px #0000004d;margin-bottom:10px}.overview[_ngcontent-%COMP%]{font-size:clamp(.9rem,1vw + .2rem,1.1rem);line-height:1.6;color:#ddd}.crew-info[_ngcontent-%COMP%]{margin-top:20px;font-size:16px;color:#ccc}.crew-type[_ngcontent-%COMP%]{margin-bottom:8px}a.person-link[_ngcontent-%COMP%]{color:#42b6d6;font-weight:500;text-decoration:none}a.person-link[_ngcontent-%COMP%]:hover{color:#61c9e6}.job[_ngcontent-%COMP%]{font-style:italic;margin-left:4px}.cast-container[_ngcontent-%COMP%]{margin-top:clamp(20px,4vw,40px);margin-left:110px;max-width:1200px;flex-wrap:wrap;margin-inline:auto;padding-inline:clamp(10px,4vw,40px)}.section-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:15px;color:#fff}.cast-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px}.actions-container[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem}.action-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background-color:#28283c99;border:1px solid #555;border-radius:8px;padding:clamp(.4rem,1vw,.75rem) clamp(1rem,2vw,1.5rem);color:#ddd;font-weight:500;font-size:clamp(.9rem,1vw,1rem)}.action-button[_ngcontent-%COMP%]:hover{background-color:#505078cc;color:#fff;transform:scale(1.02)}.icon[_ngcontent-%COMP%]{font-size:1.2rem;color:#f1b903}.rating-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-top:20px;flex-wrap:wrap}.rating-label[_ngcontent-%COMP%]{font-weight:600;color:#ccc}.current-rating[_ngcontent-%COMP%]{font-size:.95rem;color:#bbb}.custom-ngb-rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:23px;color:#f1b903}.custom-ngb-rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{transform:scale(1.2);color:gold}.current-rating[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:snow}"]})};export{ne as MovieDetailsComponent};
